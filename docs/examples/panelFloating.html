<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Spectrum CSS Floating Panel Example</title>
    <meta name="viewport" content="user-scalable=no,initial-scale = 1.0,maximum-scale = 1.0">

    <link rel="stylesheet" href="../components/commons/index-vars.css">
    <link rel="stylesheet" href="../components/page/index-vars.css">
    <link rel="stylesheet" href="../components/typography/index-vars.css">
    <link rel="stylesheet" href="../components/icon/index-vars.css">
    <link rel="stylesheet" href="../components/button/index-vars.css">
    <link rel="stylesheet" href="../components/buttongroup/index-vars.css">
    <link rel="stylesheet" href="../components/panel/index-vars.css">

    <script src="../icons/loadIcons.js"></script>
    <script src="js/vendor/focus-ring-polyfill.js"></script>
    <script src="js/vendor/typekit.js"></script>
    <script src="js/Switcher.js"></script>
    <script src="js/kbSwitcher.js"></script>
    <script>
      loadIcons('../icons/spectrum-css-icons.svg');
      loadIcons('../icons/spectrum-icons.svg');

      let startX = 0, startY = 0;
      let offsetX = 0, offsetY = 0;
      let currentElement = null;
      let currentZIndex = 10;

      document.addEventListener('mousedown', startDragging);

      function finishDragging(e) {
        document.removeEventListener('mouseup', finishDragging);
        document.removeEventListener('mousemove', handleDrag);
        currentElement = null;
      }

      function handleDrag(e) {
        e.preventDefault();
        currentElement.style.top = (e.clientY - offsetY) + "px";
        currentElement.style.left = (e.clientX - offsetX) + "px";
      }

      function startDragging(e) {
        if (e.target.hasAttribute('dragHandle')) {
          // Find if the element or anyone up the tree is draggable
          let element = e.target.closest('[draggablePanel]');

          if (element) {
            e.preventDefault();

            offsetY = e.clientY - element.offsetTop;
            offsetX = e.clientX - element.offsetLeft;

            currentElement = element;

            currentElement.style.zIndex = ++currentZIndex;

            document.addEventListener('mouseup', finishDragging);
            document.addEventListener('mousemove', handleDrag);
          }
        }
      }

    </script>
  </head>
  <body class="spectrum spectrum--light spectrum--medium">

      <div class="spectrum-Panel spectrum-Panel--vertical spectrum-Panel--floating" draggablePanel style="left: 60px; top: 60px">
        <div class="spectrum-Panel-dragHandle" dragHandle></div>
        <div class="spectrum-ButtonGroup spectrum-ButtonGroup--vertical">
          <button class="spectrum-Tool">
            <svg class="spectrum-Icon spectrum-Icon--sizeS" focusable="false" aria-hidden="true" aria-label="Select">
              <use xlink:href="#spectrum-icon-18-Select" />
            </svg>
          </button>

          <button class="spectrum-Tool is-selected">
            <svg class="spectrum-Icon spectrum-Icon--sizeS" focusable="false" aria-hidden="true" aria-label="Text">
              <use xlink:href="#spectrum-icon-18-Text" />
            </svg>
          </button>

          <button class="spectrum-Tool">
            <svg class="spectrum-Icon spectrum-Icon--sizeS" focusable="false" aria-hidden="true" aria-label="Rectangle">
              <use xlink:href="#spectrum-icon-18-Rectangle" />
            </svg>
          </button>
        </div>
      </div>

      <div class="spectrum-Panel spectrum-Panel--floating" draggablePanel style="left: 160px; top: 100px">
        <div class="spectrum-Panel-dragHandle" dragHandle></div>
        <div class="spectrum-ButtonGroup">
          <button class="spectrum-ActionButton spectrum-ActionButton--quiet">
            <span class="spectrum-ActionButton-label">Edit</span>
          </button>
          <button class="spectrum-ActionButton spectrum-ActionButton--quiet">
            <span class="spectrum-ActionButton-label">Copy</span>
          </button>
          <button class="spectrum-ActionButton spectrum-ActionButton--quiet">
            <span class="spectrum-ActionButton-label">Delete</span>
          </button>
        </div>
      </div>


  </body>
</html>